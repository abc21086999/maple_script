# MapleScript
ä¸€å€‹åŸºæ–¼è¦–è¦ºè¾¨è­˜ã€Seeed Studio Xiao ESP32S3ã€CircuitPythonã€GUI çš„è‡ªå‹•åŒ–è…³æœ¬ç¨‹å¼ï¼Œæä¾›ç›´è¦ºçš„æ“ä½œã€è·¯å¾‘éŒ„è£½åŠŸèƒ½ã€‚

ä¸»è¦ç›®çš„æ˜¯æ‰“é€ **æœ‰è€³æœµçš„éµç›¤ã€æ»‘é¼ **ï¼Œèƒ½å¤ ä¸€é‚Šè½ï¼ˆè¾¨è­˜ç•«é¢ï¼‰ï¼Œä¸€é‚ŠæŒ‰ä¸‹æŒ‰éµæˆ–æ˜¯ä¸€é‚Šç§»å‹•æ»‘é¼ ã€‚

## âœ¨ ä¸»è¦ç‰¹è‰²
- **ç¾ä»£åŒ–æ§åˆ¶ä¸­å¿ƒ**ï¼šåŸºæ–¼ PySide6 çš„æ·±è‰²ä¸»é¡Œä»‹é¢ã€‚
- **è·¯å¾‘éŒ„è£½èˆ‡é‡æ’­**ï¼šæ”¯æ´æ‰‹å‹•éŒ„è£½ç·´åŠŸå¾ªç’°è·¯å¾‘ï¼Œä¸¦å¯¦ç¾é«˜ç²¾åº¦çš„æ™‚é–“åºåˆ—é‡æ’­ã€‚
- **å®‰å…¨é˜²è­·æ©Ÿåˆ¶**ï¼š
  - **è‡ªå‹•åµæ¸¬æš«åœ**ï¼šåµæ¸¬åˆ°ç¬¦æ–‡ (Rune) æˆ–å…¶ä»–ç©å®¶ (ç´…é») æ™‚è‡ªå‹•æš«åœã€‚
  - **ç·Šæ€¥åœæ­¢ (STOP)**ï¼šä¸€éµå³æ™‚ä¸­æ–·æ‰€æœ‰èƒŒæ™¯ä»»å‹™ã€‚
- **å…¨è‡ªå‹•åŒ–åŠŸèƒ½**ï¼š
  - **è‡ªå‹•ç·´åŠŸ (Auto Grind)**ï¼šæ”¯æ´ã€Œå®šé»æ¨¡å¼ã€èˆ‡ã€Œè·¯å¾‘å¾ªç’°æ¨¡å¼ã€ï¼Œè‡ªå‹•è¾¨è­˜ä¸¦æ–½æ”¾å†·å»å®Œç•¢çš„æŠ€èƒ½ã€‚
  - **æ¯æ—¥è¡Œç¨‹å…¨è‡ªå‹•**ï¼šè‡ªå‹•è™•ç†æ¯æ—¥/æ¯é€±ä»»å‹™ã€æˆ°åœ°ç¡¬å¹£ã€HD çå‹µã€é‡Œç¨‹ã€æ‹è³£å ´ã€å¸«å¾’èˆ‡å°å±‹ã€‚
  - **è¼”åŠ©å·¥å…·**ï¼šæ€ªç‰©è’è—ã€è£å‚™åˆ†è§£ã€å€‰åº«å¯†ç¢¼è‡ªå‹•è¼¸å…¥ã€‚

## ğŸ› ï¸ ç’°å¢ƒéœ€æ±‚èˆ‡å®‰è£

1.  **ç¡¬é«”æº–å‚™**ï¼š
    - éœ€è¦ä¸€å¡Š **èƒ½åˆ·å…¥ CircuitPython** çš„é–‹ç™¼æ¿ã€‚
    - å°‡ `code/` è³‡æ–™å¤¾å…§çš„ç¨‹å¼ç¢¼ç‡’éŒ„è‡³é–‹ç™¼æ¿ã€‚
2. **åŸ·è¡Œå¯åŸ·è¡Œæª”ï¼ˆexeï¼‰**
3. **æˆ–æ˜¯å®‰è£Pythonå’Œç›¸ä¾å¥—ä»¶å¾Œæœ¬åœ°é‹è¡Œ**ï¼š
    - å®‰è£ Python 3.10+
    - å»ºç«‹ä¸¦å•Ÿå‹•è™›æ“¬ç’°å¢ƒï¼š
      ```bash
      python -m venv venv
      .\venv\Scripts\activate
      ```
    - å®‰è£ç›¸ä¾å¥—ä»¶ï¼š
      ```bash
      pip install -r requirements.txt
      ```
    - å•Ÿå‹•ä¸»ç¨‹å¼ï¼š
      ```bash
      python main.py
      ```   
3.  **è‡ªå‹•é…ç½®**ï¼š
    - å•Ÿå‹•ç¨‹å¼å¾Œï¼Œé€éå„ä»»å‹™æ—çš„ **âš™ï¸ è¨­å®šæŒ‰éˆ•** å³å¯å®ŒæˆæŠ€èƒ½æŒ‰éµã€åœ–ç‰‡æ“·å–èˆ‡è·¯å¾‘éŒ„è£½ã€‚

## ğŸš€ ä½¿ç”¨æ–¹å¼

- **ç¡¬é«”é€£ç·š**ï¼šç³»çµ±æœƒæ ¹æ“šåºè™Ÿè‡ªå‹•åŒ¹é…é–‹ç™¼æ¿ï¼Œè‹¥é€£ç·šå¤±æ•—å°‡å½ˆå‡ºè¨ºæ–·è¦–çª—å¼•å°è¨­å®šã€‚
- **ä»»å‹™åŸ·è¡Œ**ï¼šåœ¨å·¦å´é¢æ¿é¸æ“‡ä»»å‹™é»æ“Šå•Ÿå‹•ï¼Œå³å´æœƒé¡¯ç¤ºå³æ™‚åŸ·è¡Œç´€éŒ„ã€‚
- **åƒæ•¸è¨­å®š**ï¼šé€éæŒ‰éˆ•æ—çš„é½’è¼ªåœ–ç¤ºé€²å…¥è¨­å®šé é¢ã€‚
- **å®‰å…¨ä¸­æ–·**ï¼šéš¨æ™‚é»æ“Šç´…è‰² **ã€ŒğŸ”´ ç·Šæ€¥åœæ­¢ã€** æŒ‰éˆ•å¯ç«‹å³åœæ­¢è…³æœ¬ã€‚

## ğŸ—ï¸ è»Ÿé«”æ¶æ§‹æµç¨‹

ç¾åœ¨çš„æ¶æ§‹æ¡ç”¨ **å¤šåŸ·è¡Œç·’ ï¼ˆMulti-threadingï¼‰** è¨­è¨ˆï¼Œç¢ºä¿ä»‹é¢æµæš¢ä¸”æ“ä½œå®‰å…¨ã€‚

```mermaid
graph TD
    User[ä½¿ç”¨è€…] -->|é»æ“ŠæŒ‰éˆ•| GUI[åœ–å½¢ä»‹é¢ ï¼ˆPySide6ï¼‰]
    
    subgraph "å‰ç«¯ ï¼ˆMain Threadï¼‰"
        GUI -->|å•Ÿå‹•ä»»å‹™| TaskManager[ä»»å‹™ç®¡å®¶]
        GUI -->|æŒ‰ä¸‹åœæ­¢| TaskManager
        LogSignal[Log ä¿¡è™Ÿæ©‹æ¨‘] -.->|æ›´æ–°æ–‡å­—| GUI
    end

    subgraph "å¾Œç«¯ ï¼ˆWorker Threadï¼‰"
        TaskManager -->|ç”¢ç”Ÿç¨ç«‹åŸ·è¡Œç·’| Worker[å·¥ä½œåŸ·è¡Œç·’]
        Worker -->|åŸ·è¡Œé‚è¼¯| Script[MapleScript ï¼ˆç·´åŠŸï¼æ‰“ç‹...ï¼‰]
        
        Script -->|å›å ±é€²åº¦| LogSignal
        Script -->|æª¢æŸ¥åœæ­¢ä¿¡è™Ÿ| StopEvent{æ˜¯å¦åœæ­¢?}
        
        Script -->|è¦–è¦ºè¾¨è­˜| Vision[é›»è…¦è¦–è¦º ï¼ˆOpenCVï¼‰]
        Script -->|æ§åˆ¶æŒ‡ä»¤| Controller[Xiao æ§åˆ¶å™¨]
    end

    subgraph "ç¡¬é«”å±¤"
        Controller ==>|USB Serial| XiaoBoard[Xiao ESP32S3]
        XiaoBoard ==>|HID| Game[æ¥“ä¹‹è°·è¦–çª—]
    end
```

## ğŸ”Œ ç¡¬é«”äº’å‹•åŸç†
```mermaid
%%{init: {'theme': 'forest'} }%%
graph LR;

step1[Xiaoåˆå§‹åŒ–ç‚ºéµç›¤ã€æ»‘é¼ ]

step2[é›»è…¦è¾¨è­˜ç•«é¢]

step3[å­˜å…¥list]

step4[å–å‡ºå‚³é€çµ¦Xiao]

step5[XiaoæŒ‰ä¸‹æŒ‰éµ]

step6[é›»è…¦æ”¶åˆ°]

step7[Xiaoç§»å‹•æ»‘é¼ ]

step8[é›»è…¦è¨ˆç®—æ»‘é¼ è¦ç§»å‹•çš„è·é›¢]

step9[æ»‘é¼ æ»¾è¼ªè¦ä¸Šä¸‹æ»¾å‹•]

step10[Xiaoæ»¾è¼ªä¸Šä¸‹æ»‘å‹•]

step11[Xiaoé»æ“Š]

step12[æœ‰è¦æŒ‰ä¸‹çš„æŒ‰éµ]

step13[æœ‰è¦é•·å£“ä¹‹å¾Œæ”¾é–‹çš„æŒ‰éµ]

step14[Xiaoé•·å£“å¾Œæ”¾é–‹]

%% æµç¨‹ç·š -->
step1 ==> step2
step1 ==> step8
step1 ==> step9
step1 ==> step12
step1 ==> step13
step5 ==> step6
step14 ==> step6
step11 ==> step6
step10 ==> step6

subgraph éµç›¤
step2 ==> step3 ==> step4 ==> step5
step12 ==> step5
step13 ==> step14
end
subgraph æ»‘é¼ 
step8 ==> step7 ==> step11
step9 ==> step10
end
```